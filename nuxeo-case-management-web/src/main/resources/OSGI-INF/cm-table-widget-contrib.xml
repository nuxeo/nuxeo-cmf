<?xml version="1.0"?>

<component name="com.nuxeo.cm.table.widget">

  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="widgettypes">
    <widgetType name="listing_cm_title_link">
      <documentation>
        This widget type displays a link to navigate to a case.
        <br />
        It requires the following fields configuration:
        <ul>
          <li>
            first field maps the document model, it will be used to display the
            document link and its title
          </li>
          <li>
            second field maps the unique id to be used for contextual menu (e.g.
            the document model id)
          </li>
          <li>third field maps the caseLink's caseDocumentId.</li>
        </ul>
      </documentation>

      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_title_link_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_inbox_title_link">

      <documentation>
        This widget type displays a link to navigate to a case.
        <br />
        It requires the following fields configuration:
        <ul>
          <li>
            first field maps the document model, it will be used to display the
            document link and its title
          </li>
          <li>
            second field maps the unique id to be used for contextual menu (e.g.
            the document model id)
          </li>
          <li>third field maps the caseLink's caseDocumentId.</li>
          <li>fouth field maps the isRead property of a caseLink.</li>
        </ul>
      </documentation>

      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_inbox_title_link_widget_template.xhtml
      </property>

    </widgetType>

    <widgetType name="listing_draft_title_link">

      <documentation>
        This widget type displays a link to navigate to a case.
        <br />
        It requires the following fields configuration:
        <ul>
          <li>
            first field maps the document model, it will be used to display the
            document link and its title
          </li>
          <li>
            second field maps the unique id to be used for contextual menu (e.g.
            the document model id)
          </li>
          <li>third field maps the caseLink's caseDocumentId.</li>
        </ul>
      </documentation>

      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_draft_title_link_widget_template.xhtml
      </property>

    </widgetType>

    <widgetType name="listing_cm_text_history_action">
      <documentation>
        This widget type displays a action logged by the audit.
        <br />
        It requires the following fields configuration:
        <ul>
          <li>first field maps the entryId for the entryLog</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_history_action_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_text_history_username">
      <documentation>
        This widget type displays the username for a given principal
        <br />
        It requires the following fields configuration:
        <ul>
          <li>first field maps the principalName</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_username_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_text_distribution_history_comment">
      <documentation>
        This widget type displays a comment logged by the audit.
        <br />
        It requires the following fields configuration:
        <ul>
          <li>first field maps the logEntry</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_dis_history_comment_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_text_distribution_action_recipient">
      <documentation>
        This widget type displays the action recipients logged by the audit.
        <br />
        It requires the following fields configuration:
        <ul>
          <li>first field maps the logEntry</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_dis_history_action_recepients_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_text_distribution_copy_recipient">
      <documentation>
        This widget type displays the copy recipients logged by the audit.
        <br />
        It requires the following fields configuration:
        <ul>
          <li>first field maps the logEntry</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_dis_history_copy_recepients_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_relations_outgoing_predicate">
      <documentation>
        This widget type displays the prdicate in a relation
        <br />
        It requires the following fields configuration:
        <ul>
          <li>statement.predicate.uri</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_relations_outgoing_predicate_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_relations_incoming_predicate">
      <documentation>
        This widget type displays the prdicate in a relation
        <br />
        It requires the following fields configuration:
        <ul>
          <li>statement.predicate.uri</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_relations_incoming_predicate_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_relations_object">
      <documentation>
        This widget type displays the prdicate in a relation
        <br />
        It requires the following fields configuration:
        <ul>
          <li>statement.</li>
          <li>statement.objectInfo</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_relations_object_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_relations_comment">
      <documentation>
        This widget type displays the comment in a relation
        <br />
        It requires the following fields configuration:
        <ul>
          <li>statement.</li>
          <li>statement.comment</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_relations_comment_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_relations_actions">
      <documentation>
        This widget type displays the actions that a user can perform on the
        documents from relation
        <br />
        It requires the following fields configuration:
        <ul>
          <li>statement.</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_text_relations_actions_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_inbox_actionable_case_link_actions">

      <documentation>
        This widget type displays 2 links to approve or reject a task
        <br />
        It requires the following fields configuration:
        <ul>
          <li>
            first field maps the document model, it will be used to display the
            document link and its title
          </li>
          <li>
            second field maps the unique id to be used for contextual menu (e.g.
            the document model id)
          </li>
          <li>third field maps the caseLink's caseDocumentId.</li>
          <li>fouth field maps the isRead property of a caseLink.</li>
        </ul>
      </documentation>

      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_inbox_actionable_case_link_actions_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_routing_task_type_widget">
      <documentation>
        This widget type displays the prdicate in a relation
        <br />
        It requires the following fields configuration:
        <ul>
          <li>directory name</li>
          <li>data</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_routing_task_type_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_routing_doc_properties">
      <documentation>
        This widget type displays some task properties
        <br />
        It requires the following fields configuration:
        <ul>
          <li>the documentRouteElement</li>
        </ul>
      </documentation>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/listing/listing_cm_routing_doc_properties_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="listing_cm_route_title_link">

      <documentation>
        This widget type displays a link to a route. It opens a new window
        with route as selected tab.
        <br />
        It requires the following fields configuration:
        <ul>
          <li>
            first field maps the document model, it will be used to display the
            document link and its title
          </li>
        </ul>
      </documentation>

      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /documentrouting_widgets/listing/listing_cm_case_linked_route_widget_template.xhtml
      </property>
    </widgetType>
    
     <widgetType name="listing_cm_case_display_popup_related_route">

      <documentation>
        This widget type displays a link to a route.
        It displays the route in a popup.
        <br />
        It requires the following fields configuration:
        <ul>
          <li>
            first field maps the document model, it will be used to display the
            document link and its title
          </li>
        </ul>
      </documentation>

      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /documentrouting_widgets/listing/listing_cm_case_display_popup_related_route_widget_template.xhtml
      </property>
    </widgetType>

  </extension>

  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="widgets">

    <widget name="cm_icon_type" type="listing_icon_type">
      <labels>
        <label mode="any"></label>
      </labels>
      <fields>
        <field>data</field>
        <field>data.id</field>
        <field>data.type</field>
      </fields>
    </widget>

    <widget name="cm_listing_title_link" type="listing_title_link">
      <labels>
        <label mode="any">label.content.header.title</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data</field>
        <field>data.ref</field>
        <field>data.cslk.senderMailboxId</field>
      </fields>
    </widget>

    <widget name="cm_mailbox_listing_title_link" type="listing_cm_title_link">
      <labels>
        <label mode="any">label.content.header.title</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data</field>
        <field>data.ref</field>
        <field>data.cslk.caseDocumentId</field>
      </fields>
    </widget>

    <widget name="cm_mailbox_inbox_listing_title_link"
      type="listing_inbox_title_link">
      <labels>
        <label mode="any">label.content.header.title</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data</field>
        <field>data.id</field>
        <field>data.cslk.caseDocumentId</field>
        <field>data.cslk.isRead</field>
      </fields>
    </widget>

    <widget name="cm_mailbox_draft_listing_title_link"
      type="listing_draft_title_link">
      <labels>
        <label mode="any">label.content.header.title</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data</field>
        <field>data.id</field>
        <field>data.cslk.caseDocumentId</field>
      </fields>
    </widget>

    <widget name="cm_listing_sending_date" type="datetime">
      <labels>
        <label mode="any">label.content.header.date</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.cslk.date</field>
      </fields>
      <properties widgetMode="any">
        <property name="pattern">#{nxu:basicDateAndTimeFormater()}</property>
      </properties>
    </widget>

    <widget name="cm_listing_sender" type="listing_author">
      <labels>
        <label mode="any">label.content.header.sender</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.cslk.sender</field>
      </fields>
    </widget>

    <widget name="cm_listing_uid" type="text">
      <labels>
        <label mode="any">label.content.header.uid</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.uid.uid</field>
      </fields>
    </widget>

    <widget name="cm_history_action" type="listing_cm_text_history_action">
      <labels>
        <label mode="any">label.performedAction</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.eventId</field>
      </fields>
    </widget>

    <widget name="cm_history_date" type="datetime">
      <labels>
        <label mode="any">label.time</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.eventDate</field>
      </fields>
      <properties widgetMode="any">
        <property name="pattern">#{nxu:basicDateAndTimeFormater()}</property>
      </properties>
    </widget>

    <widget name="cm_history_username"
      type="listing_cm_text_history_username">
      <labels>
        <label mode="any">label.username</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.principalName</field>
      </fields>
    </widget>

    <widget name="cm_distribution_history_comment"
      type="listing_cm_text_distribution_history_comment">
      <labels>
        <label mode="any">label.comment</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.id</field>
      </fields>
    </widget>

    <widget name="cm_history_comment" type="text">
      <labels>
        <label mode="any">label.comment</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.comment</field>
      </fields>
    </widget>

    <widget name="cm_distribution_history_action_recipients"
      type="listing_cm_text_distribution_action_recipient">
      <labels>
        <label mode="any">
          label.casemanagement.distribution.history.actionParticipants
        </label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data</field>
      </fields>
    </widget>

    <widget name="cm_distribution_history_copy_recipients"
      type="listing_cm_text_distribution_copy_recipient">
      <labels>
        <label mode="any">
          label.casemanagement.distribution.history.copyParticipants
        </label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data</field>
      </fields>
    </widget>

    <widget name="cm_relations_outgoing_predicate"
      type="listing_cm_relations_outgoing_predicate">
      <labels>
        <label mode="any">label.relation.predicate</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.predicate.uri</field>
      </fields>
    </widget>

    <widget name="cm_relations_incoming_predicate"
      type="listing_cm_relations_incoming_predicate">
      <labels>
        <label mode="any">label.relation.predicate</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.predicate.uri</field>
      </fields>
    </widget>

    <widget name="cm_relations_object" type="listing_cm_relations_object">
      <labels>
        <label mode="any">label.relation.object</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data</field>
        <field>data.objectInfo</field>
      </fields>
    </widget>

    <widget name="cm_relations_comment" type="listing_cm_relations_comment">
      <labels>
        <label mode="any">label.relation.comment</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data</field>
        <field>data.comment</field>
      </fields>
    </widget>

    <widget name="cm_relations_actions" type="listing_cm_relations_actions">
      <labels>
        <label mode="any">label.operations</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data</field>
      </fields>
    </widget>

    <widget name="cm_relations_date" type="datetime">
      <labels>
        <label mode="any">label.content.header.created</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.creationDate</field>
      </fields>
      <properties widgetMode="any">
        <property name="pattern">#{nxu:basicDateAndTimeFormater()}</property>
      </properties>
    </widget>

    <widget name="cm_relations_author" type="text">
      <labels>
        <label mode="any">label.content.header.author</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.author</field>
      </fields>
    </widget>

    <widget name="cm_inbox_actionable_case_link_actions"
      type="listing_cm_inbox_actionable_case_link_actions">
      <labels>
        <label mode="any">
          label.casemanagement.distribution.task.operations
        </label>
      </labels>
      <fields>
        <field>data</field>
      </fields>
    </widget>

    <widget name="cm_listing_routing_task_type"
      type="listing_cm_routing_task_type_widget">
      <labels>
        <label mode="any">label.casemanagement.distribution.task.type</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.document</field>
        <field>data.document.rtsk.type</field>
      </fields>
    </widget>

    <widget name="cm_listing_routing_task_due_date"
      type="listing_cm_routing_doc_properties">
      <labels>
        <label mode="any">label.casemanagement.routing.task.dueDate</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.document.rtsk.dueDate</field>
        <field>data.document.hasFacet('RouteStep')</field>
      </fields>
    </widget>

    <widget name="cm_listing_routing_task_mailbox"
      type="listing_cm_routing_doc_properties">
      <labels>
        <label mode="any">label.casemanagement.routing.task.mailboxId</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>data.document.rtsk.distributionMailboxId</field>
        <field>data.document.hasFacet('RouteStep')</field>
      </fields>
    </widget>

    <widget name="cm_listing_route_title_link"
      type="listing_cm_route_title_link">
      <labels>
        <label mode="any">label.content.header.title</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>document</field>
      </fields>
    </widget>

    <widget name="cm_case_display_popup_related_route"
      type="listing_cm_case_display_popup_related_route">
      <labels>
        <label mode="any">label.content.header.title</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>document</field>
      </fields>
    </widget>
    
     <widget name="dr_history_listing_document_route_folder_element_type"
      type="listing_document_route_folder_element_type">
      <labels>
        <label mode="any">label.document.route.content.header.type</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>routeElement.document</field>
        <field>routeElement.document.id</field>
        <field>routeElement.document.hasFacet('Folderish')</field>
      </fields>
      <properties mode="any">
        <property name="showAvailableActionsOnRouteElement">false</property>
      </properties>
    </widget> 
    
  </extension>

</component>
